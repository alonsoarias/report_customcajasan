/**
 * JavaScript for the report_customcajasan report
 *
 * @module     block_report_customcajasan/report
 * @copyright  2025 Cajasan
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_report_customcajasan/report",["jquery","core/notification","core/str"],(function($,Notification,Str){var currentPage=0;function loadReportData(){$("#report-results").addClass("loading");var formData=$("#report-form").serialize();formData+="&page="+currentPage,formData+="&sesskey="+M.cfg.sesskey,$.ajax({url:M.cfg.wwwroot+"/blocks/report_customcajasan/ajax/get_report_data.php",type:"GET",data:formData,dataType:"json",success:function(response){response&&response.success?($("#report-results").html(response.html),initializeDynamicElements(),$("#enrollment-report-table tbody tr").each((function(){var statusCell=$(this).find("td:eq(9)"),statusText=statusCell.text().trim();"COMPLETO"===statusText?statusCell.addClass("bg-success text-white"):"EN PROGRESO"===statusText?statusCell.addClass("bg-warning"):"FINALIZADO"===statusText?statusCell.addClass("bg-info text-white"):"CONSULTA"===statusText&&statusCell.addClass("bg-secondary text-white")}))):Str.get_string("ajax_error","block_report_customcajasan").then((function(errorString){$("#report-results").html('<div class="alert alert-danger">'+errorString+"</div>")})).catch(Notification.exception)},error:function(xhr,status,error){Str.get_string("ajax_error_detail","block_report_customcajasan").then((function(errorString){$("#report-results").html('<div class="alert alert-danger">'+errorString+": "+status+"</div>")})).catch(Notification.exception)},complete:function(){$("#report-results").removeClass("loading")}})}function initializeDynamicElements(){$(".pagination .page-link").on("click",(function(e){e.preventDefault();var page=$(this).data("page");void 0!==page&&(currentPage=page,loadReportData())}))}return{init:function(){var idnumberTimer;$("#categoryid").on("change",(function(){var categoryId=$(this).val();$("#courseid").empty();var allText=M.util.get_string("option_all","block_report_customcajasan");$("#courseid").append($("<option>",{value:"",text:allText})),categoryId?$.ajax({url:M.cfg.wwwroot+"/blocks/report_customcajasan/ajax/get_courses.php",type:"GET",data:{categoryid:categoryId,sesskey:M.cfg.sesskey},dataType:"json",success:function(data){data.success&&data.courses&&$.each(data.courses,(function(index,course){$("#courseid").append($("<option>",{value:course.id,text:course.fullname}))})),currentPage=0,loadReportData()},error:function(){Notification.exception({message:"Error loading courses"}),currentPage=0,loadReportData()}}):(currentPage=0,loadReportData())})),$(".alphabet-filter a").on("click",(function(e){e.preventDefault();var letter=$(this).data("letter"),target=$(this).data("target");$("#"+target).val(letter),$(this).closest(".alphabet-filter").find("a").removeClass("active"),$(this).addClass("active"),currentPage=0,loadReportData()})),$("#report-form").on("submit",(function(e){e.preventDefault(),currentPage=0,loadReportData()})),$("#estado, #courseid").on("change",(function(){currentPage=0,loadReportData()})),$("#startdate, #enddate").on("change",(function(){currentPage=0,loadReportData()})),$("#idnumber").on("input",(function(){clearTimeout(idnumberTimer),idnumberTimer=setTimeout((function(){currentPage=0,loadReportData()}),500)})),$("#report-results").length&&($("#categoryid").val()||$("#courseid").val()||$("#estado").val()||$("#idnumber").val()||$("#firstname").val()||$("#lastname").val()||$("#startdate").val()||$("#enddate").val())&&loadReportData(),initializeDynamicElements()}}}));

//# sourceMappingURL=report.min.js.map